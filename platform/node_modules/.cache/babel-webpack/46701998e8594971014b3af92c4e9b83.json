{"ast":null,"code":"import _asyncToGenerator from \"/Users/laurenzhinterholzer/Documents/WIN/WIN 2022S/BAC WIN/platform/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../course-management/course-management.service\";\nimport * as i2 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"../../shared/students/student-service\";\nimport * as i5 from \"app/core/util/event-manager.service\";\nimport * as i6 from \"ngx-spinner\";\nimport * as i7 from \"@rxweb/reactive-form-validators\";\nimport * as i8 from \"../../../shared/language/translate.directive\";\nimport * as i9 from \"../../../shared/alert/alert-error.component\";\nimport * as i10 from \"@ng-select/ng-select\";\nimport * as i11 from \"@fortawesome/angular-fontawesome\";\nimport * as i12 from \"@ngx-translate/core\";\nconst _c0 = [\"csvFile\"];\n\nconst _c1 = function () {\n  return {\n    standalone: true\n  };\n};\n\nfunction StudentAssignmentModalComponent_ng_template_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n          \");\n    i0.ɵɵelement(1, \"input\", 25);\n    i0.ɵɵtext(2);\n  }\n\n  if (rf & 2) {\n    const item_r3 = ctx.item;\n    const item$_r4 = ctx.item$;\n    const index_r5 = ctx.index;\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"id\", \"item-\", index_r5, \"\");\n    i0.ɵɵproperty(\"ngModelOptions\", i0.ɵɵpureFunction0(4, _c1))(\"ngModel\", item$_r4.selected);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \\u00A0\", item_r3.firstName + \" \" + item_r3.lastName, \"\\n        \");\n  }\n}\n/**\n * Component for managing the student assignment.\n */\n\n\nexport class StudentAssignmentModalComponent {\n  /**\n   * Constructor.\n   *\n   * @param courseService the injected course service\n   * @param activeModal the injected active modal service\n   * @param fb the injected form builder\n   * @param studentService the injected student service\n   * @param eventManager the injected jhi event manager\n   * @param spinner the injected spinner service\n   */\n  constructor(courseService, activeModal, fb, studentService, eventManager, spinner) {\n    this.courseService = courseService;\n    this.activeModal = activeModal;\n    this.fb = fb;\n    this.studentService = studentService;\n    this.eventManager = eventManager;\n    this.spinner = spinner;\n    this.isSaving = false;\n    this.fileSelected = false;\n    this.assignmentForm = this.fb.group({\n      students: [[], []],\n      csvFile: [null, []]\n    });\n    this.availableStudents = [];\n  }\n  /**\n   * Implements the init method. See {@link OnInit}.\n   */\n\n\n  ngOnInit() {\n    this.studentService.getAvailableStudents().subscribe(value => this.availableStudents = value);\n  }\n  /**\n   * Saves the student assignment.\n   */\n\n\n  save() {\n    this.saveAsync();\n  }\n  /**\n   * Closes the modal window\n   */\n\n\n  close() {\n    this.activeModal.dismiss();\n  }\n  /**\n   * Sets the course instance.\n   *\n   * @param value the value to set\n   */\n\n\n  set courseInstance(value) {\n    this._courseInstance = value;\n    this.courseService.getAssignedStudentsOfCourseInstance(value.id).subscribe(assignedStudents => this.assignmentForm.patchValue({\n      students: assignedStudents.map(x => x.matriculationNumber)\n    }));\n  }\n  /**\n   * Returns the course instance.\n   */\n\n\n  get courseInstance() {\n    return this._courseInstance;\n  }\n  /**\n   * Removes the file from the file input dialog\n   */\n\n\n  removeFile() {\n    this.assignmentForm.patchValue({\n      csvFile: undefined\n    });\n    this.fileSelected = false;\n    this.fileInputRef.nativeElement.value = '';\n  }\n  /**\n   * Detects a file fileupload\n   */\n\n\n  fileChanged() {\n    this.fileSelected = true;\n  }\n  /**\n   * Asynchronously saves the assigned students.\n   */\n\n\n  saveAsync() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      _this.isSaving = true;\n\n      _this.spinner.show();\n\n      if (_this.assignmentForm.get(['csvFile']).value !== undefined && _this.assignmentForm.get(['csvFile']).value !== null) {\n        const fileList = _this.assignmentForm.get(['csvFile']).value;\n\n        if (fileList.length === 1) {\n          const csvFile = fileList.item(0);\n\n          try {\n            yield _this.courseService.uploadStudents(_this.courseInstance.id, csvFile).toPromise();\n          } catch (e) {\n            _this.spinner.hide();\n\n            _this.isSaving = false;\n            throw e;\n          }\n\n          _this.eventManager.broadcast('course-instance-stud-assignment-changed');\n\n          _this.spinner.hide();\n\n          _this.isSaving = false;\n\n          _this.activeModal.close();\n\n          return;\n        }\n      }\n\n      try {\n        yield _this.courseService.setAssignedStudents(_this.courseInstance.id, _this.assignmentForm.get(['students']).value).toPromise();\n      } catch (e) {\n        _this.spinner.hide();\n\n        _this.isSaving = false;\n        throw e;\n      }\n\n      _this.eventManager.broadcast('course-instance-stud-assignment-changed');\n\n      _this.spinner.hide();\n\n      _this.isSaving = false;\n\n      _this.activeModal.close();\n    })();\n  }\n\n}\n\nStudentAssignmentModalComponent.ɵfac = function StudentAssignmentModalComponent_Factory(t) {\n  return new (t || StudentAssignmentModalComponent)(i0.ɵɵdirectiveInject(i1.CourseManagementService), i0.ɵɵdirectiveInject(i2.NgbActiveModal), i0.ɵɵdirectiveInject(i3.FormBuilder), i0.ɵɵdirectiveInject(i4.StudentService), i0.ɵɵdirectiveInject(i5.EventManager), i0.ɵɵdirectiveInject(i6.NgxSpinnerService));\n};\n\nStudentAssignmentModalComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: StudentAssignmentModalComponent,\n  selectors: [[\"jhi-student-assignment-modal\"]],\n  viewQuery: function StudentAssignmentModalComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 7);\n    }\n\n    if (rf & 2) {\n      let _t;\n\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.fileInputRef = _t.first);\n    }\n  },\n  decls: 77,\n  vars: 19,\n  consts: [[\"role\", \"form\", 3, \"formGroup\", \"ngSubmit\"], [1, \"modal-header\"], [\"jhiTranslate\", \"courseManagement.instances.overview.assignStudentsHeader\", 1, \"modal-title\"], [\"type\", \"button\", \"data-dismiss\", \"modal\", \"aria-hidden\", \"true\", 1, \"close\", 3, \"click\"], [1, \"modal-body\"], [1, \"form-group\"], [\"for\", \"students\", \"jhiTranslate\", \"courseManagement.instances.overview.assignStudentsLabel\", 1, \"form-control-label\"], [\"formControlName\", \"students\", \"id\", \"students\", \"bindValue\", \"matriculationNumber\", \"bindLabel\", \"fullName\", 3, \"placeholder\", \"items\", \"multiple\", \"closeOnSelect\", \"notFoundText\"], [\"students\", \"\"], [\"ng-option-tmp\", \"\"], [1, \"form-control-label\"], [\"icon\", \"info-circle\", \"placement\", \"right\", 3, \"ngbTooltip\"], [1, \"form-row\"], [1, \"col-md-10\"], [\"type\", \"file\", \"placeholder\", \"Fileupload\", \"accept\", \".csv,.CSV\", \"id\", \"csvFile\", \"formControlName\", \"csvFile\", 1, \"form-control-file\", 3, \"writeFile\", \"change\"], [\"csvFile\", \"\"], [1, \"col-md-2\"], [\"type\", \"button\", \"jhiTranslate\", \"courseManagement.instances.overview.csvReset\", 1, \"btn\", \"btn-secondary\", 3, \"disabled\", \"click\"], [1, \"modal-footer\"], [\"type\", \"button\", 1, \"btn\", \"btn-secondary\", 3, \"click\"], [\"icon\", \"ban\"], [\"jhiTranslate\", \"courseManagement.form.cancel\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"disabled\"], [\"icon\", \"save\"], [\"jhiTranslate\", \"courseManagement.form.save\"], [\"type\", \"checkbox\", 3, \"ngModelOptions\", \"id\", \"ngModel\"]],\n  template: function StudentAssignmentModalComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"form\", 0);\n      i0.ɵɵlistener(\"ngSubmit\", function StudentAssignmentModalComponent_Template_form_ngSubmit_0_listener() {\n        return ctx.save();\n      });\n      i0.ɵɵtext(1, \"\\n  \");\n      i0.ɵɵelementStart(2, \"div\", 1);\n      i0.ɵɵtext(3, \"\\n    \");\n      i0.ɵɵelementStart(4, \"h4\", 2);\n      i0.ɵɵtext(5, \"Adjust student assignments\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(6, \"\\n\\n    \");\n      i0.ɵɵelementStart(7, \"button\", 3);\n      i0.ɵɵlistener(\"click\", function StudentAssignmentModalComponent_Template_button_click_7_listener() {\n        return ctx.close();\n      });\n      i0.ɵɵtext(8, \"\\u00D7\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(9, \"\\n  \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(10, \"\\n\\n  \");\n      i0.ɵɵelementStart(11, \"div\", 4);\n      i0.ɵɵtext(12, \"\\n    \");\n      i0.ɵɵelement(13, \"ngx-spinner\");\n      i0.ɵɵtext(14, \"\\n    \");\n      i0.ɵɵelement(15, \"jhi-alert-error\");\n      i0.ɵɵtext(16, \"\\n    \");\n      i0.ɵɵelementStart(17, \"div\", 5);\n      i0.ɵɵtext(18, \"\\n      \");\n      i0.ɵɵelementStart(19, \"label\", 6);\n      i0.ɵɵtext(20, \"Students:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(21, \"\\n\\n      \");\n      i0.ɵɵelementStart(22, \"ng-select\", 7, 8);\n      i0.ɵɵpipe(24, \"translate\");\n      i0.ɵɵpipe(25, \"translate\");\n      i0.ɵɵtext(26, \"\\n        \");\n      i0.ɵɵtemplate(27, StudentAssignmentModalComponent_ng_template_27_Template, 3, 5, \"ng-template\", 9);\n      i0.ɵɵtext(28, \"\\n      \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(29, \"\\n    \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(30, \"\\n    \");\n      i0.ɵɵelementStart(31, \"div\", 5);\n      i0.ɵɵtext(32, \"\\n      \");\n      i0.ɵɵelementStart(33, \"label\", 10);\n      i0.ɵɵtext(34);\n      i0.ɵɵpipe(35, \"translate\");\n      i0.ɵɵelement(36, \"fa-icon\", 11);\n      i0.ɵɵpipe(37, \"translate\");\n      i0.ɵɵtext(38, \"\\n      \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(39, \"\\n      \");\n      i0.ɵɵelementStart(40, \"div\", 12);\n      i0.ɵɵtext(41, \"\\n        \");\n      i0.ɵɵelementStart(42, \"div\", 13);\n      i0.ɵɵtext(43, \"\\n          \");\n      i0.ɵɵelementStart(44, \"input\", 14, 15);\n      i0.ɵɵlistener(\"change\", function StudentAssignmentModalComponent_Template_input_change_44_listener() {\n        return ctx.fileChanged();\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(46, \"\\n        \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(47, \"\\n        \");\n      i0.ɵɵelementStart(48, \"div\", 16);\n      i0.ɵɵtext(49, \"\\n          \");\n      i0.ɵɵelementStart(50, \"button\", 17);\n      i0.ɵɵlistener(\"click\", function StudentAssignmentModalComponent_Template_button_click_50_listener() {\n        return ctx.removeFile();\n      });\n      i0.ɵɵtext(51, \"\\n            Remove CSV file\\n          \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(52, \"\\n        \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(53, \"\\n      \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(54, \"\\n    \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(55, \"\\n  \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(56, \"\\n\\n  \");\n      i0.ɵɵelementStart(57, \"div\", 18);\n      i0.ɵɵtext(58, \"\\n    \");\n      i0.ɵɵelementStart(59, \"button\", 19);\n      i0.ɵɵlistener(\"click\", function StudentAssignmentModalComponent_Template_button_click_59_listener() {\n        return ctx.close();\n      });\n      i0.ɵɵtext(60, \"\\n      \");\n      i0.ɵɵelement(61, \"fa-icon\", 20);\n      i0.ɵɵtext(62, \"\\u00A0\");\n      i0.ɵɵelementStart(63, \"span\", 21);\n      i0.ɵɵtext(64, \"Cancel\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(65, \"\\n    \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(66, \"\\n\\n    \");\n      i0.ɵɵelementStart(67, \"button\", 22);\n      i0.ɵɵtext(68, \"\\n      \");\n      i0.ɵɵelement(69, \"fa-icon\", 23);\n      i0.ɵɵtext(70, \"\\u00A0\");\n      i0.ɵɵelementStart(71, \"span\", 24);\n      i0.ɵɵtext(72, \"Save\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(73, \"\\n    \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(74, \"\\n  \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(75, \"\\n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(76, \"\\n\");\n    }\n\n    if (rf & 2) {\n      i0.ɵɵproperty(\"formGroup\", ctx.assignmentForm);\n      i0.ɵɵadvance(22);\n      i0.ɵɵpropertyInterpolate(\"placeholder\", i0.ɵɵpipeBind1(24, 11, \"courseManagement.instances.overview.assignStudentsPlaceholder\"));\n      i0.ɵɵpropertyInterpolate(\"notFoundText\", i0.ɵɵpipeBind1(25, 13, \"courseManagement.instances.overview.assignStudentsNotFoundText\"));\n      i0.ɵɵproperty(\"items\", ctx.availableStudents)(\"multiple\", true)(\"closeOnSelect\", false);\n      i0.ɵɵadvance(12);\n      i0.ɵɵtextInterpolate1(\"\\n        \", i0.ɵɵpipeBind1(35, 15, \"courseManagement.instances.overview.studentUploadLabel\"), \"\\n        \");\n      i0.ɵɵadvance(2);\n      i0.ɵɵpropertyInterpolate(\"ngbTooltip\", i0.ɵɵpipeBind1(37, 17, \"courseManagement.instances.overview.studentUploadInfoTooltip\"));\n      i0.ɵɵadvance(8);\n      i0.ɵɵproperty(\"writeFile\", true);\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"disabled\", !ctx.fileSelected);\n      i0.ɵɵadvance(17);\n      i0.ɵɵproperty(\"disabled\", ctx.assignmentForm.invalid || ctx.isSaving);\n    }\n  },\n  directives: [i3.ɵNgNoValidate, i3.NgControlStatusGroup, i3.FormGroupDirective, i7.ɵa, i8.TranslateDirective, i6.NgxSpinnerComponent, i9.AlertErrorComponent, i10.NgSelectComponent, i3.NgControlStatus, i3.FormControlName, i7.ɵk, i7.ɵe, i10.ɵf, i11.FaIconComponent, i2.NgbTooltip, i7.ɵi, i7.ɵj, i3.DefaultValueAccessor, i3.CheckboxControlValueAccessor, i3.NgModel],\n  pipes: [i12.TranslatePipe],\n  encapsulation: 2\n});","map":{"version":3,"sources":["/Users/laurenzhinterholzer/Documents/WIN/WIN 2022S/BAC WIN/platform/src/main/webapp/app/overview/course-management-shared/student-assignment-modal/student-assignment-modal.component.ts"],"names":["i0","i1","i2","i3","i4","i5","i6","i7","i8","i9","i10","i11","i12","_c0","_c1","standalone","StudentAssignmentModalComponent_ng_template_27_Template","rf","ctx","ɵɵtext","ɵɵelement","item_r3","item","item$_r4","item$","index_r5","index","ɵɵadvance","ɵɵpropertyInterpolate1","ɵɵproperty","ɵɵpureFunction0","selected","ɵɵtextInterpolate1","firstName","lastName","StudentAssignmentModalComponent","constructor","courseService","activeModal","fb","studentService","eventManager","spinner","isSaving","fileSelected","assignmentForm","group","students","csvFile","availableStudents","ngOnInit","getAvailableStudents","subscribe","value","save","saveAsync","close","dismiss","courseInstance","_courseInstance","getAssignedStudentsOfCourseInstance","id","assignedStudents","patchValue","map","x","matriculationNumber","removeFile","undefined","fileInputRef","nativeElement","fileChanged","show","get","fileList","length","uploadStudents","toPromise","e","hide","broadcast","setAssignedStudents","ɵfac","StudentAssignmentModalComponent_Factory","t","ɵɵdirectiveInject","CourseManagementService","NgbActiveModal","FormBuilder","StudentService","EventManager","NgxSpinnerService","ɵcmp","ɵɵdefineComponent","type","selectors","viewQuery","StudentAssignmentModalComponent_Query","ɵɵviewQuery","_t","ɵɵqueryRefresh","ɵɵloadQuery","first","decls","vars","consts","template","StudentAssignmentModalComponent_Template","ɵɵelementStart","ɵɵlistener","StudentAssignmentModalComponent_Template_form_ngSubmit_0_listener","ɵɵelementEnd","StudentAssignmentModalComponent_Template_button_click_7_listener","ɵɵpipe","ɵɵtemplate","StudentAssignmentModalComponent_Template_input_change_44_listener","StudentAssignmentModalComponent_Template_button_click_50_listener","StudentAssignmentModalComponent_Template_button_click_59_listener","ɵɵpropertyInterpolate","ɵɵpipeBind1","invalid","directives","ɵNgNoValidate","NgControlStatusGroup","FormGroupDirective","ɵa","TranslateDirective","NgxSpinnerComponent","AlertErrorComponent","NgSelectComponent","NgControlStatus","FormControlName","ɵk","ɵe","ɵf","FaIconComponent","NgbTooltip","ɵi","ɵj","DefaultValueAccessor","CheckboxControlValueAccessor","NgModel","pipes","TranslatePipe","encapsulation"],"mappings":"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","sourcesContent":["import * as i0 from \"@angular/core\";\nimport * as i1 from \"../../course-management/course-management.service\";\nimport * as i2 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"../../shared/students/student-service\";\nimport * as i5 from \"app/core/util/event-manager.service\";\nimport * as i6 from \"ngx-spinner\";\nimport * as i7 from \"@rxweb/reactive-form-validators\";\nimport * as i8 from \"../../../shared/language/translate.directive\";\nimport * as i9 from \"../../../shared/alert/alert-error.component\";\nimport * as i10 from \"@ng-select/ng-select\";\nimport * as i11 from \"@fortawesome/angular-fontawesome\";\nimport * as i12 from \"@ngx-translate/core\";\nconst _c0 = [\"csvFile\"];\nconst _c1 = function () { return { standalone: true }; };\nfunction StudentAssignmentModalComponent_ng_template_27_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵtext(0, \"\\n          \");\n    i0.ɵɵelement(1, \"input\", 25);\n    i0.ɵɵtext(2);\n} if (rf & 2) {\n    const item_r3 = ctx.item;\n    const item$_r4 = ctx.item$;\n    const index_r5 = ctx.index;\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"id\", \"item-\", index_r5, \"\");\n    i0.ɵɵproperty(\"ngModelOptions\", i0.ɵɵpureFunction0(4, _c1))(\"ngModel\", item$_r4.selected);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \\u00A0\", item_r3.firstName + \" \" + item_r3.lastName, \"\\n        \");\n} }\n/**\n * Component for managing the student assignment.\n */\nexport class StudentAssignmentModalComponent {\n    /**\n     * Constructor.\n     *\n     * @param courseService the injected course service\n     * @param activeModal the injected active modal service\n     * @param fb the injected form builder\n     * @param studentService the injected student service\n     * @param eventManager the injected jhi event manager\n     * @param spinner the injected spinner service\n     */\n    constructor(courseService, activeModal, fb, studentService, eventManager, spinner) {\n        this.courseService = courseService;\n        this.activeModal = activeModal;\n        this.fb = fb;\n        this.studentService = studentService;\n        this.eventManager = eventManager;\n        this.spinner = spinner;\n        this.isSaving = false;\n        this.fileSelected = false;\n        this.assignmentForm = this.fb.group({\n            students: [[], []],\n            csvFile: [null, []],\n        });\n        this.availableStudents = [];\n    }\n    /**\n     * Implements the init method. See {@link OnInit}.\n     */\n    ngOnInit() {\n        this.studentService.getAvailableStudents().subscribe(value => (this.availableStudents = value));\n    }\n    /**\n     * Saves the student assignment.\n     */\n    save() {\n        this.saveAsync();\n    }\n    /**\n     * Closes the modal window\n     */\n    close() {\n        this.activeModal.dismiss();\n    }\n    /**\n     * Sets the course instance.\n     *\n     * @param value the value to set\n     */\n    set courseInstance(value) {\n        this._courseInstance = value;\n        this.courseService.getAssignedStudentsOfCourseInstance(value.id).subscribe(assignedStudents => this.assignmentForm.patchValue({\n            students: assignedStudents.map(x => x.matriculationNumber),\n        }));\n    }\n    /**\n     * Returns the course instance.\n     */\n    get courseInstance() {\n        return this._courseInstance;\n    }\n    /**\n     * Removes the file from the file input dialog\n     */\n    removeFile() {\n        this.assignmentForm.patchValue({\n            csvFile: undefined,\n        });\n        this.fileSelected = false;\n        this.fileInputRef.nativeElement.value = '';\n    }\n    /**\n     * Detects a file fileupload\n     */\n    fileChanged() {\n        this.fileSelected = true;\n    }\n    /**\n     * Asynchronously saves the assigned students.\n     */\n    async saveAsync() {\n        this.isSaving = true;\n        this.spinner.show();\n        if (this.assignmentForm.get(['csvFile']).value !== undefined && this.assignmentForm.get(['csvFile']).value !== null) {\n            const fileList = this.assignmentForm.get(['csvFile']).value;\n            if (fileList.length === 1) {\n                const csvFile = fileList.item(0);\n                try {\n                    await this.courseService.uploadStudents(this.courseInstance.id, csvFile).toPromise();\n                }\n                catch (e) {\n                    this.spinner.hide();\n                    this.isSaving = false;\n                    throw e;\n                }\n                this.eventManager.broadcast('course-instance-stud-assignment-changed');\n                this.spinner.hide();\n                this.isSaving = false;\n                this.activeModal.close();\n                return;\n            }\n        }\n        try {\n            await this.courseService.setAssignedStudents(this.courseInstance.id, this.assignmentForm.get(['students']).value).toPromise();\n        }\n        catch (e) {\n            this.spinner.hide();\n            this.isSaving = false;\n            throw e;\n        }\n        this.eventManager.broadcast('course-instance-stud-assignment-changed');\n        this.spinner.hide();\n        this.isSaving = false;\n        this.activeModal.close();\n    }\n}\nStudentAssignmentModalComponent.ɵfac = function StudentAssignmentModalComponent_Factory(t) { return new (t || StudentAssignmentModalComponent)(i0.ɵɵdirectiveInject(i1.CourseManagementService), i0.ɵɵdirectiveInject(i2.NgbActiveModal), i0.ɵɵdirectiveInject(i3.FormBuilder), i0.ɵɵdirectiveInject(i4.StudentService), i0.ɵɵdirectiveInject(i5.EventManager), i0.ɵɵdirectiveInject(i6.NgxSpinnerService)); };\nStudentAssignmentModalComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StudentAssignmentModalComponent, selectors: [[\"jhi-student-assignment-modal\"]], viewQuery: function StudentAssignmentModalComponent_Query(rf, ctx) { if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 7);\n    } if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.fileInputRef = _t.first);\n    } }, decls: 77, vars: 19, consts: [[\"role\", \"form\", 3, \"formGroup\", \"ngSubmit\"], [1, \"modal-header\"], [\"jhiTranslate\", \"courseManagement.instances.overview.assignStudentsHeader\", 1, \"modal-title\"], [\"type\", \"button\", \"data-dismiss\", \"modal\", \"aria-hidden\", \"true\", 1, \"close\", 3, \"click\"], [1, \"modal-body\"], [1, \"form-group\"], [\"for\", \"students\", \"jhiTranslate\", \"courseManagement.instances.overview.assignStudentsLabel\", 1, \"form-control-label\"], [\"formControlName\", \"students\", \"id\", \"students\", \"bindValue\", \"matriculationNumber\", \"bindLabel\", \"fullName\", 3, \"placeholder\", \"items\", \"multiple\", \"closeOnSelect\", \"notFoundText\"], [\"students\", \"\"], [\"ng-option-tmp\", \"\"], [1, \"form-control-label\"], [\"icon\", \"info-circle\", \"placement\", \"right\", 3, \"ngbTooltip\"], [1, \"form-row\"], [1, \"col-md-10\"], [\"type\", \"file\", \"placeholder\", \"Fileupload\", \"accept\", \".csv,.CSV\", \"id\", \"csvFile\", \"formControlName\", \"csvFile\", 1, \"form-control-file\", 3, \"writeFile\", \"change\"], [\"csvFile\", \"\"], [1, \"col-md-2\"], [\"type\", \"button\", \"jhiTranslate\", \"courseManagement.instances.overview.csvReset\", 1, \"btn\", \"btn-secondary\", 3, \"disabled\", \"click\"], [1, \"modal-footer\"], [\"type\", \"button\", 1, \"btn\", \"btn-secondary\", 3, \"click\"], [\"icon\", \"ban\"], [\"jhiTranslate\", \"courseManagement.form.cancel\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"disabled\"], [\"icon\", \"save\"], [\"jhiTranslate\", \"courseManagement.form.save\"], [\"type\", \"checkbox\", 3, \"ngModelOptions\", \"id\", \"ngModel\"]], template: function StudentAssignmentModalComponent_Template(rf, ctx) { if (rf & 1) {\n        i0.ɵɵelementStart(0, \"form\", 0);\n        i0.ɵɵlistener(\"ngSubmit\", function StudentAssignmentModalComponent_Template_form_ngSubmit_0_listener() { return ctx.save(); });\n        i0.ɵɵtext(1, \"\\n  \");\n        i0.ɵɵelementStart(2, \"div\", 1);\n        i0.ɵɵtext(3, \"\\n    \");\n        i0.ɵɵelementStart(4, \"h4\", 2);\n        i0.ɵɵtext(5, \"Adjust student assignments\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(6, \"\\n\\n    \");\n        i0.ɵɵelementStart(7, \"button\", 3);\n        i0.ɵɵlistener(\"click\", function StudentAssignmentModalComponent_Template_button_click_7_listener() { return ctx.close(); });\n        i0.ɵɵtext(8, \"\\u00D7\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(9, \"\\n  \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(10, \"\\n\\n  \");\n        i0.ɵɵelementStart(11, \"div\", 4);\n        i0.ɵɵtext(12, \"\\n    \");\n        i0.ɵɵelement(13, \"ngx-spinner\");\n        i0.ɵɵtext(14, \"\\n    \");\n        i0.ɵɵelement(15, \"jhi-alert-error\");\n        i0.ɵɵtext(16, \"\\n    \");\n        i0.ɵɵelementStart(17, \"div\", 5);\n        i0.ɵɵtext(18, \"\\n      \");\n        i0.ɵɵelementStart(19, \"label\", 6);\n        i0.ɵɵtext(20, \"Students:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(21, \"\\n\\n      \");\n        i0.ɵɵelementStart(22, \"ng-select\", 7, 8);\n        i0.ɵɵpipe(24, \"translate\");\n        i0.ɵɵpipe(25, \"translate\");\n        i0.ɵɵtext(26, \"\\n        \");\n        i0.ɵɵtemplate(27, StudentAssignmentModalComponent_ng_template_27_Template, 3, 5, \"ng-template\", 9);\n        i0.ɵɵtext(28, \"\\n      \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(29, \"\\n    \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(30, \"\\n    \");\n        i0.ɵɵelementStart(31, \"div\", 5);\n        i0.ɵɵtext(32, \"\\n      \");\n        i0.ɵɵelementStart(33, \"label\", 10);\n        i0.ɵɵtext(34);\n        i0.ɵɵpipe(35, \"translate\");\n        i0.ɵɵelement(36, \"fa-icon\", 11);\n        i0.ɵɵpipe(37, \"translate\");\n        i0.ɵɵtext(38, \"\\n      \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(39, \"\\n      \");\n        i0.ɵɵelementStart(40, \"div\", 12);\n        i0.ɵɵtext(41, \"\\n        \");\n        i0.ɵɵelementStart(42, \"div\", 13);\n        i0.ɵɵtext(43, \"\\n          \");\n        i0.ɵɵelementStart(44, \"input\", 14, 15);\n        i0.ɵɵlistener(\"change\", function StudentAssignmentModalComponent_Template_input_change_44_listener() { return ctx.fileChanged(); });\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(46, \"\\n        \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(47, \"\\n        \");\n        i0.ɵɵelementStart(48, \"div\", 16);\n        i0.ɵɵtext(49, \"\\n          \");\n        i0.ɵɵelementStart(50, \"button\", 17);\n        i0.ɵɵlistener(\"click\", function StudentAssignmentModalComponent_Template_button_click_50_listener() { return ctx.removeFile(); });\n        i0.ɵɵtext(51, \"\\n            Remove CSV file\\n          \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(52, \"\\n        \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(53, \"\\n      \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(54, \"\\n    \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(55, \"\\n  \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(56, \"\\n\\n  \");\n        i0.ɵɵelementStart(57, \"div\", 18);\n        i0.ɵɵtext(58, \"\\n    \");\n        i0.ɵɵelementStart(59, \"button\", 19);\n        i0.ɵɵlistener(\"click\", function StudentAssignmentModalComponent_Template_button_click_59_listener() { return ctx.close(); });\n        i0.ɵɵtext(60, \"\\n      \");\n        i0.ɵɵelement(61, \"fa-icon\", 20);\n        i0.ɵɵtext(62, \"\\u00A0\");\n        i0.ɵɵelementStart(63, \"span\", 21);\n        i0.ɵɵtext(64, \"Cancel\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(65, \"\\n    \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(66, \"\\n\\n    \");\n        i0.ɵɵelementStart(67, \"button\", 22);\n        i0.ɵɵtext(68, \"\\n      \");\n        i0.ɵɵelement(69, \"fa-icon\", 23);\n        i0.ɵɵtext(70, \"\\u00A0\");\n        i0.ɵɵelementStart(71, \"span\", 24);\n        i0.ɵɵtext(72, \"Save\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(73, \"\\n    \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(74, \"\\n  \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(75, \"\\n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(76, \"\\n\");\n    } if (rf & 2) {\n        i0.ɵɵproperty(\"formGroup\", ctx.assignmentForm);\n        i0.ɵɵadvance(22);\n        i0.ɵɵpropertyInterpolate(\"placeholder\", i0.ɵɵpipeBind1(24, 11, \"courseManagement.instances.overview.assignStudentsPlaceholder\"));\n        i0.ɵɵpropertyInterpolate(\"notFoundText\", i0.ɵɵpipeBind1(25, 13, \"courseManagement.instances.overview.assignStudentsNotFoundText\"));\n        i0.ɵɵproperty(\"items\", ctx.availableStudents)(\"multiple\", true)(\"closeOnSelect\", false);\n        i0.ɵɵadvance(12);\n        i0.ɵɵtextInterpolate1(\"\\n        \", i0.ɵɵpipeBind1(35, 15, \"courseManagement.instances.overview.studentUploadLabel\"), \"\\n        \");\n        i0.ɵɵadvance(2);\n        i0.ɵɵpropertyInterpolate(\"ngbTooltip\", i0.ɵɵpipeBind1(37, 17, \"courseManagement.instances.overview.studentUploadInfoTooltip\"));\n        i0.ɵɵadvance(8);\n        i0.ɵɵproperty(\"writeFile\", true);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"disabled\", !ctx.fileSelected);\n        i0.ɵɵadvance(17);\n        i0.ɵɵproperty(\"disabled\", ctx.assignmentForm.invalid || ctx.isSaving);\n    } }, directives: [i3.ɵNgNoValidate, i3.NgControlStatusGroup, i3.FormGroupDirective, i7.ɵa, i8.TranslateDirective, i6.NgxSpinnerComponent, i9.AlertErrorComponent, i10.NgSelectComponent, i3.NgControlStatus, i3.FormControlName, i7.ɵk, i7.ɵe, i10.ɵf, i11.FaIconComponent, i2.NgbTooltip, i7.ɵi, i7.ɵj, i3.DefaultValueAccessor, i3.CheckboxControlValueAccessor, i3.NgModel], pipes: [i12.TranslatePipe], encapsulation: 2 });\n"]},"metadata":{},"sourceType":"module"}