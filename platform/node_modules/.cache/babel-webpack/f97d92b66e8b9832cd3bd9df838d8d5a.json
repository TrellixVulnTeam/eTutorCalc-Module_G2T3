{"ast":null,"code":"import _asyncToGenerator from \"/Users/laurenzhinterholzer/Documents/WIN/WIN 2022S/BAC WIN/platform/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { FormArray } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./student-self-evaluation.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../../course-management/course-management.service\";\nimport * as i4 from \"app/core/auth/account.service\";\nimport * as i5 from \"@angular/forms\";\nimport * as i6 from \"@rxweb/reactive-form-validators\";\nimport * as i7 from \"../../../shared/alert/alert-error.component\";\nimport * as i8 from \"../../../shared/language/translate.directive\";\nimport * as i9 from \"@angular/common\";\nimport * as i10 from \"@fortawesome/angular-fontawesome\";\nimport * as i11 from \"@ngx-translate/core\";\n\nconst _c0 = function (a0) {\n  return {\n    goal: a0\n  };\n};\n\nfunction StudentSelfEvaluationComponent_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 10);\n    i0.ɵɵtext(1, \"\\n      \");\n    i0.ɵɵelementStart(2, \"div\", 11);\n    i0.ɵɵtext(3, \"\\n        \");\n    i0.ɵɵelementStart(4, \"h6\", 12);\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(7, \"\\n        \");\n    i0.ɵɵelementStart(8, \"div\", 13);\n    i0.ɵɵtext(9, \"\\n          \");\n    i0.ɵɵelementStart(10, \"input\", 14);\n    i0.ɵɵlistener(\"click\", function StudentSelfEvaluationComponent_div_13_Template_input_click_10_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const goalItem_r3 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ɵɵnextContext();\n      return ctx_r5.markGoalAsReachedClicked(goalItem_r3);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(11, \"\\n          \");\n    i0.ɵɵelementStart(12, \"label\", 15);\n    i0.ɵɵtext(13, \" Yes \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(14, \"\\n        \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(15, \"\\n        \");\n    i0.ɵɵelementStart(16, \"div\", 13);\n    i0.ɵɵtext(17, \"\\n          \");\n    i0.ɵɵelementStart(18, \"input\", 14);\n    i0.ɵɵlistener(\"click\", function StudentSelfEvaluationComponent_div_13_Template_input_click_18_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const goalItem_r3 = restoredCtx.$implicit;\n      const ctx_r7 = i0.ɵɵnextContext();\n      return ctx_r7.markGoalAsNotReachedClicked(goalItem_r3);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(19, \"\\n          \");\n    i0.ɵɵelementStart(20, \"label\", 16);\n    i0.ɵɵtext(21, \" No \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(22, \"\\n        \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(23, \"\\n      \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(24, \"\\n    \");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const goalItem_r3 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"formGroup\", goalItem_r3.group);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"\\n          \", i0.ɵɵpipeBind2(6, 4, \"overview.student.selfEvaluation.cardTitle\", i0.ɵɵpureFunction1(7, _c0, goalItem_r3.group.get(\"text\").value)), \"\\n        \");\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"value\", true);\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"value\", false);\n  }\n}\n\nfunction StudentSelfEvaluationComponent_span_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"span\", 17);\n  }\n}\n\nfunction StudentSelfEvaluationComponent_fa_icon_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"fa-icon\", 18);\n  }\n}\n\nconst _c1 = function (a0) {\n  return {\n    course: a0\n  };\n}; // noinspection JSIgnoredPromiseFromCall\n\n/**\n * Component for the student self evaluation.\n */\n\n\nexport class StudentSelfEvaluationComponent {\n  /**\n   * Constructor.\n   *\n   * @param studentSelfEvaluationService the injected student self evaluation service\n   * @param activatedRoute the injected activated route service\n   * @param router the injected router\n   * @param courseManagementService the injected course management service\n   * @param accountService the injected account service\n   * @param fb the injected reactive form builder\n   */\n  constructor(studentSelfEvaluationService, activatedRoute, router, courseManagementService, accountService, fb) {\n    this.studentSelfEvaluationService = studentSelfEvaluationService;\n    this.activatedRoute = activatedRoute;\n    this.router = router;\n    this.courseManagementService = courseManagementService;\n    this.accountService = accountService;\n    this.fb = fb;\n    this.goals = [];\n    this.studentSelfEvaluationForm = this.fb.group({\n      learningObjectives: new FormArray([])\n    });\n    this.isSaving = false;\n    this._login = this.accountService.getLoginName();\n    const nav = this.router.getCurrentNavigation();\n\n    if (nav === null || nav === void 0 ? void 0 : nav.extras.state) {\n      this._instance = nav.extras.state.instance;\n    } else {\n      this.router.navigate(['/']);\n    }\n  }\n  /**\n   * Implements the init method. See {@link OnInit}.\n   */\n\n\n  ngOnInit() {\n    this.loadLearningGoalsAsync();\n  }\n  /**\n   * Submits the changes.\n   */\n\n\n  submitChanges() {\n    this.isSaving = true;\n    const goals = [];\n\n    for (const formGroup of this.formArrayControlsAsFormGroup) {\n      const id = formGroup.get('id').value;\n      const text = formGroup.get('text').value;\n      const completed = formGroup.get('completed').value;\n      goals.push({\n        id,\n        text,\n        completed\n      });\n    }\n\n    this.studentSelfEvaluationService.saveEvaluation(this.courseInstanceInfo.instanceId, goals).subscribe(() => {\n      this.isSaving = false;\n      this.navigateBack();\n    }, () => {\n      this.isSaving = false;\n    });\n  }\n  /**\n   * Navigates back.\n   */\n\n\n  navigateBack() {\n    this.router.navigate(['/', 'overview']);\n  }\n  /**\n   * Returns the controls as form array.\n   */\n\n\n  get controlsAsFormArray() {\n    return this.studentSelfEvaluationForm.get('learningObjectives');\n  }\n  /**\n   * Returns the controls as a form group.\n   */\n\n\n  get formArrayControlsAsFormGroup() {\n    return this.controlsAsFormArray.controls;\n  }\n  /**\n   * Returns the course instance information.\n   */\n\n\n  get courseInstanceInfo() {\n    return this._instance;\n  }\n  /**\n   * Marks the selected goal (and all its sub goals) as reached.\n   *\n   * @param goal the selected goal\n   */\n\n\n  markGoalAsReachedClicked(goal) {\n    this.markGoalAsReachedRecursive(goal);\n  }\n  /**\n   * Marks the selected goal (and all its super goals) as not reached.\n   *\n   * @param goal the selected goal\n   */\n\n\n  markGoalAsNotReachedClicked(goal) {\n    this.markGoalAsUnreachedRecursive(goal);\n  }\n  /**\n   * Recursively marks the goal and its sub goals as reached.\n   *\n   * @param goal the goal which should be marked as reached\n   */\n\n\n  markGoalAsReachedRecursive(goal) {\n    goal.completed = true;\n    goal.group.patchValue({\n      completed: true\n    });\n\n    for (let i = 0; i < goal.subGoals.length; i++) {\n      this.markGoalAsReachedRecursive(goal.subGoals[i]);\n    }\n  }\n  /**\n   * Recursively\n   *\n   * @param goal the goal which should be marked as unreached\n   */\n\n\n  markGoalAsUnreachedRecursive(goal) {\n    goal.completed = false;\n    goal.group.patchValue({\n      completed: false\n    });\n\n    if (goal.parentGoal) {\n      this.markGoalAsUnreachedRecursive(goal.parentGoal);\n    }\n  }\n  /**\n   * Asynchronously loads the learning goals and initializes the\n   * dynamic form.\n   */\n\n\n  loadLearningGoalsAsync() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      if (_this._instance) {\n        const goals = yield _this.courseManagementService.getLearningGoalsFromCourse(_this._instance.courseName, _this._login).toPromise();\n        const formArray = _this.controlsAsFormArray;\n\n        for (const goal of goals) {\n          _this.getLearningGoalsRecursive(goal, formArray, undefined);\n        }\n      }\n    })();\n  }\n  /**\n   * Recursively goes through the given learning goal tree\n   * and adds the current goal to the list of available goals.\n   *\n   * @param goal the root goal\n   * @param formArray the form array\n   * @param parentGoal the optional parent goal\n   */\n\n\n  getLearningGoalsRecursive(goal, formArray, parentGoal) {\n    const group = this.fb.group({\n      id: [goal.value],\n      text: [goal.text],\n      completed: [false]\n    });\n    formArray.push(group);\n    const newGoal = {\n      id: goal.value,\n      text: goal.text,\n      completed: false,\n      subGoals: [],\n      parentGoal,\n      group\n    };\n    this.goals.push(newGoal);\n\n    for (const child of goal.childItems) {\n      const childGoal = this.getLearningGoalsRecursive(child, formArray, newGoal);\n      newGoal.subGoals.push(childGoal);\n    }\n\n    return newGoal;\n  }\n\n}\n\nStudentSelfEvaluationComponent.ɵfac = function StudentSelfEvaluationComponent_Factory(t) {\n  return new (t || StudentSelfEvaluationComponent)(i0.ɵɵdirectiveInject(i1.StudentSelfEvaluationService), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.CourseManagementService), i0.ɵɵdirectiveInject(i4.AccountService), i0.ɵɵdirectiveInject(i5.FormBuilder));\n};\n\nStudentSelfEvaluationComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: StudentSelfEvaluationComponent,\n  selectors: [[\"jhi-student-self-evaluation\"]],\n  decls: 33,\n  vars: 12,\n  consts: [[3, \"formGroup\", \"ngSubmit\"], [1, \"card\", \"m-3\"], [\"jhiTranslate\", \"overview.student.selfEvaluation.cardHeader\", 1, \"card-header\"], [\"class\", \"list-group list-group-flush\", 4, \"ngFor\", \"ngForOf\"], [1, \"card-footer\", \"text-center\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", \"mr-2\", 3, \"disabled\"], [\"class\", \"spinner-border spinner-border-sm mr-1\", 4, \"ngIf\"], [\"icon\", \"save\", 4, \"ngIf\"], [\"jhiTranslate\", \"overview.student.selfEvaluation.save\"], [\"type\", \"button\", \"jhiTranslate\", \"overview.student.selfEvaluation.cancel\", 1, \"btn\", \"btn-secondary\", 3, \"disabled\", \"click\"], [1, \"list-group\", \"list-group-flush\"], [1, \"list-group-item\", 3, \"formGroup\"], [1, \"card-title\"], [1, \"form-check-inline\"], [\"type\", \"radio\", \"formControlName\", \"completed\", 1, \"form-check-input\", 3, \"value\", \"click\"], [\"jhiTranslate\", \"overview.student.selfEvaluation.yes\", 1, \"form-check-label\"], [\"jhiTranslate\", \"overview.student.selfEvaluation.no\", 1, \"form-check-label\"], [1, \"spinner-border\", \"spinner-border-sm\", \"mr-1\"], [\"icon\", \"save\"]],\n  template: function StudentSelfEvaluationComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"form\", 0);\n      i0.ɵɵlistener(\"ngSubmit\", function StudentSelfEvaluationComponent_Template_form_ngSubmit_0_listener() {\n        return ctx.submitChanges();\n      });\n      i0.ɵɵtext(1, \"\\n  \");\n      i0.ɵɵelementStart(2, \"h4\");\n      i0.ɵɵtext(3);\n      i0.ɵɵpipe(4, \"translate\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(5, \"\\n\\n  \");\n      i0.ɵɵelement(6, \"jhi-alert-error\");\n      i0.ɵɵtext(7, \"\\n\\n  \");\n      i0.ɵɵelementStart(8, \"div\", 1);\n      i0.ɵɵtext(9, \"\\n    \");\n      i0.ɵɵelementStart(10, \"h5\", 2);\n      i0.ɵɵtext(11, \"Learning goals\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(12, \"\\n    \");\n      i0.ɵɵtemplate(13, StudentSelfEvaluationComponent_div_13_Template, 25, 9, \"div\", 3);\n      i0.ɵɵtext(14, \"\\n    \");\n      i0.ɵɵelementStart(15, \"div\", 4);\n      i0.ɵɵtext(16, \"\\n      \");\n      i0.ɵɵelementStart(17, \"button\", 5);\n      i0.ɵɵtext(18, \"\\n        \");\n      i0.ɵɵtemplate(19, StudentSelfEvaluationComponent_span_19_Template, 1, 0, \"span\", 6);\n      i0.ɵɵtext(20, \"\\n        \");\n      i0.ɵɵtemplate(21, StudentSelfEvaluationComponent_fa_icon_21_Template, 1, 0, \"fa-icon\", 7);\n      i0.ɵɵtext(22, \"\\u00A0\");\n      i0.ɵɵelementStart(23, \"span\", 8);\n      i0.ɵɵtext(24, \"Save\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(25, \"\\n      \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(26, \"\\n      \");\n      i0.ɵɵelementStart(27, \"button\", 9);\n      i0.ɵɵlistener(\"click\", function StudentSelfEvaluationComponent_Template_button_click_27_listener() {\n        return ctx.navigateBack();\n      });\n      i0.ɵɵtext(28, \"\\n        Cancel\\n      \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(29, \"\\n    \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(30, \"\\n  \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(31, \"\\n\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtext(32, \"\\n\");\n    }\n\n    if (rf & 2) {\n      i0.ɵɵproperty(\"formGroup\", ctx.studentSelfEvaluationForm);\n      i0.ɵɵadvance(3);\n      i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(4, 7, \"overview.student.selfEvaluation.header\", i0.ɵɵpureFunction1(10, _c1, ctx.courseInstanceInfo.courseName)));\n      i0.ɵɵadvance(10);\n      i0.ɵɵproperty(\"ngForOf\", ctx.goals);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"disabled\", ctx.isSaving);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.isSaving);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", !ctx.isSaving);\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"disabled\", ctx.isSaving);\n    }\n  },\n  directives: [i5.ɵNgNoValidate, i5.NgControlStatusGroup, i5.FormGroupDirective, i6.ɵa, i7.AlertErrorComponent, i8.TranslateDirective, i9.NgForOf, i9.NgIf, i5.RadioControlValueAccessor, i5.DefaultValueAccessor, i5.NgControlStatus, i5.FormControlName, i6.ɵk, i6.ɵe, i10.FaIconComponent],\n  pipes: [i11.TranslatePipe],\n  encapsulation: 2\n});","map":{"version":3,"sources":["/Users/laurenzhinterholzer/Documents/WIN/WIN 2022S/BAC WIN/platform/src/main/webapp/app/overview/student-overview/student-self-evaluation/student-self-evaluation.component.ts"],"names":["FormArray","i0","i1","i2","i3","i4","i5","i6","i7","i8","i9","i10","i11","_c0","a0","goal","StudentSelfEvaluationComponent_div_13_Template","rf","ctx","_r6","ɵɵgetCurrentView","ɵɵelementStart","ɵɵtext","ɵɵpipe","ɵɵelementEnd","ɵɵlistener","StudentSelfEvaluationComponent_div_13_Template_input_click_10_listener","restoredCtx","ɵɵrestoreView","goalItem_r3","$implicit","ctx_r5","ɵɵnextContext","markGoalAsReachedClicked","StudentSelfEvaluationComponent_div_13_Template_input_click_18_listener","ctx_r7","markGoalAsNotReachedClicked","ɵɵadvance","ɵɵproperty","group","ɵɵtextInterpolate1","ɵɵpipeBind2","ɵɵpureFunction1","get","value","StudentSelfEvaluationComponent_span_19_Template","ɵɵelement","StudentSelfEvaluationComponent_fa_icon_21_Template","_c1","course","StudentSelfEvaluationComponent","constructor","studentSelfEvaluationService","activatedRoute","router","courseManagementService","accountService","fb","goals","studentSelfEvaluationForm","learningObjectives","isSaving","_login","getLoginName","nav","getCurrentNavigation","extras","state","_instance","instance","navigate","ngOnInit","loadLearningGoalsAsync","submitChanges","formGroup","formArrayControlsAsFormGroup","id","text","completed","push","saveEvaluation","courseInstanceInfo","instanceId","subscribe","navigateBack","controlsAsFormArray","controls","markGoalAsReachedRecursive","markGoalAsUnreachedRecursive","patchValue","i","subGoals","length","parentGoal","getLearningGoalsFromCourse","courseName","toPromise","formArray","getLearningGoalsRecursive","undefined","newGoal","child","childItems","childGoal","ɵfac","StudentSelfEvaluationComponent_Factory","t","ɵɵdirectiveInject","StudentSelfEvaluationService","ActivatedRoute","Router","CourseManagementService","AccountService","FormBuilder","ɵcmp","ɵɵdefineComponent","type","selectors","decls","vars","consts","template","StudentSelfEvaluationComponent_Template","StudentSelfEvaluationComponent_Template_form_ngSubmit_0_listener","ɵɵtemplate","StudentSelfEvaluationComponent_Template_button_click_27_listener","ɵɵtextInterpolate","directives","ɵNgNoValidate","NgControlStatusGroup","FormGroupDirective","ɵa","AlertErrorComponent","TranslateDirective","NgForOf","NgIf","RadioControlValueAccessor","DefaultValueAccessor","NgControlStatus","FormControlName","ɵk","ɵe","FaIconComponent","pipes","TranslatePipe","encapsulation"],"mappings":"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","sourcesContent":["import { FormArray } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./student-self-evaluation.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../../course-management/course-management.service\";\nimport * as i4 from \"app/core/auth/account.service\";\nimport * as i5 from \"@angular/forms\";\nimport * as i6 from \"@rxweb/reactive-form-validators\";\nimport * as i7 from \"../../../shared/alert/alert-error.component\";\nimport * as i8 from \"../../../shared/language/translate.directive\";\nimport * as i9 from \"@angular/common\";\nimport * as i10 from \"@fortawesome/angular-fontawesome\";\nimport * as i11 from \"@ngx-translate/core\";\nconst _c0 = function (a0) { return { goal: a0 }; };\nfunction StudentSelfEvaluationComponent_div_13_Template(rf, ctx) { if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 10);\n    i0.ɵɵtext(1, \"\\n      \");\n    i0.ɵɵelementStart(2, \"div\", 11);\n    i0.ɵɵtext(3, \"\\n        \");\n    i0.ɵɵelementStart(4, \"h6\", 12);\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(7, \"\\n        \");\n    i0.ɵɵelementStart(8, \"div\", 13);\n    i0.ɵɵtext(9, \"\\n          \");\n    i0.ɵɵelementStart(10, \"input\", 14);\n    i0.ɵɵlistener(\"click\", function StudentSelfEvaluationComponent_div_13_Template_input_click_10_listener() { const restoredCtx = i0.ɵɵrestoreView(_r6); const goalItem_r3 = restoredCtx.$implicit; const ctx_r5 = i0.ɵɵnextContext(); return ctx_r5.markGoalAsReachedClicked(goalItem_r3); });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(11, \"\\n          \");\n    i0.ɵɵelementStart(12, \"label\", 15);\n    i0.ɵɵtext(13, \" Yes \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(14, \"\\n        \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(15, \"\\n        \");\n    i0.ɵɵelementStart(16, \"div\", 13);\n    i0.ɵɵtext(17, \"\\n          \");\n    i0.ɵɵelementStart(18, \"input\", 14);\n    i0.ɵɵlistener(\"click\", function StudentSelfEvaluationComponent_div_13_Template_input_click_18_listener() { const restoredCtx = i0.ɵɵrestoreView(_r6); const goalItem_r3 = restoredCtx.$implicit; const ctx_r7 = i0.ɵɵnextContext(); return ctx_r7.markGoalAsNotReachedClicked(goalItem_r3); });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(19, \"\\n          \");\n    i0.ɵɵelementStart(20, \"label\", 16);\n    i0.ɵɵtext(21, \" No \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(22, \"\\n        \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(23, \"\\n      \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(24, \"\\n    \");\n    i0.ɵɵelementEnd();\n} if (rf & 2) {\n    const goalItem_r3 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"formGroup\", goalItem_r3.group);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"\\n          \", i0.ɵɵpipeBind2(6, 4, \"overview.student.selfEvaluation.cardTitle\", i0.ɵɵpureFunction1(7, _c0, goalItem_r3.group.get(\"text\").value)), \"\\n        \");\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"value\", true);\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"value\", false);\n} }\nfunction StudentSelfEvaluationComponent_span_19_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵelement(0, \"span\", 17);\n} }\nfunction StudentSelfEvaluationComponent_fa_icon_21_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵelement(0, \"fa-icon\", 18);\n} }\nconst _c1 = function (a0) { return { course: a0 }; };\n// noinspection JSIgnoredPromiseFromCall\n/**\n * Component for the student self evaluation.\n */\nexport class StudentSelfEvaluationComponent {\n    /**\n     * Constructor.\n     *\n     * @param studentSelfEvaluationService the injected student self evaluation service\n     * @param activatedRoute the injected activated route service\n     * @param router the injected router\n     * @param courseManagementService the injected course management service\n     * @param accountService the injected account service\n     * @param fb the injected reactive form builder\n     */\n    constructor(studentSelfEvaluationService, activatedRoute, router, courseManagementService, accountService, fb) {\n        this.studentSelfEvaluationService = studentSelfEvaluationService;\n        this.activatedRoute = activatedRoute;\n        this.router = router;\n        this.courseManagementService = courseManagementService;\n        this.accountService = accountService;\n        this.fb = fb;\n        this.goals = [];\n        this.studentSelfEvaluationForm = this.fb.group({\n            learningObjectives: new FormArray([]),\n        });\n        this.isSaving = false;\n        this._login = this.accountService.getLoginName();\n        const nav = this.router.getCurrentNavigation();\n        if (nav === null || nav === void 0 ? void 0 : nav.extras.state) {\n            this._instance = nav.extras.state.instance;\n        }\n        else {\n            this.router.navigate(['/']);\n        }\n    }\n    /**\n     * Implements the init method. See {@link OnInit}.\n     */\n    ngOnInit() {\n        this.loadLearningGoalsAsync();\n    }\n    /**\n     * Submits the changes.\n     */\n    submitChanges() {\n        this.isSaving = true;\n        const goals = [];\n        for (const formGroup of this.formArrayControlsAsFormGroup) {\n            const id = formGroup.get('id').value;\n            const text = formGroup.get('text').value;\n            const completed = formGroup.get('completed').value;\n            goals.push({\n                id,\n                text,\n                completed,\n            });\n        }\n        this.studentSelfEvaluationService.saveEvaluation(this.courseInstanceInfo.instanceId, goals).subscribe(() => {\n            this.isSaving = false;\n            this.navigateBack();\n        }, () => {\n            this.isSaving = false;\n        });\n    }\n    /**\n     * Navigates back.\n     */\n    navigateBack() {\n        this.router.navigate(['/', 'overview']);\n    }\n    /**\n     * Returns the controls as form array.\n     */\n    get controlsAsFormArray() {\n        return this.studentSelfEvaluationForm.get('learningObjectives');\n    }\n    /**\n     * Returns the controls as a form group.\n     */\n    get formArrayControlsAsFormGroup() {\n        return this.controlsAsFormArray.controls;\n    }\n    /**\n     * Returns the course instance information.\n     */\n    get courseInstanceInfo() {\n        return this._instance;\n    }\n    /**\n     * Marks the selected goal (and all its sub goals) as reached.\n     *\n     * @param goal the selected goal\n     */\n    markGoalAsReachedClicked(goal) {\n        this.markGoalAsReachedRecursive(goal);\n    }\n    /**\n     * Marks the selected goal (and all its super goals) as not reached.\n     *\n     * @param goal the selected goal\n     */\n    markGoalAsNotReachedClicked(goal) {\n        this.markGoalAsUnreachedRecursive(goal);\n    }\n    /**\n     * Recursively marks the goal and its sub goals as reached.\n     *\n     * @param goal the goal which should be marked as reached\n     */\n    markGoalAsReachedRecursive(goal) {\n        goal.completed = true;\n        goal.group.patchValue({\n            completed: true,\n        });\n        for (let i = 0; i < goal.subGoals.length; i++) {\n            this.markGoalAsReachedRecursive(goal.subGoals[i]);\n        }\n    }\n    /**\n     * Recursively\n     *\n     * @param goal the goal which should be marked as unreached\n     */\n    markGoalAsUnreachedRecursive(goal) {\n        goal.completed = false;\n        goal.group.patchValue({\n            completed: false,\n        });\n        if (goal.parentGoal) {\n            this.markGoalAsUnreachedRecursive(goal.parentGoal);\n        }\n    }\n    /**\n     * Asynchronously loads the learning goals and initializes the\n     * dynamic form.\n     */\n    async loadLearningGoalsAsync() {\n        if (this._instance) {\n            const goals = await this.courseManagementService.getLearningGoalsFromCourse(this._instance.courseName, this._login).toPromise();\n            const formArray = this.controlsAsFormArray;\n            for (const goal of goals) {\n                this.getLearningGoalsRecursive(goal, formArray, undefined);\n            }\n        }\n    }\n    /**\n     * Recursively goes through the given learning goal tree\n     * and adds the current goal to the list of available goals.\n     *\n     * @param goal the root goal\n     * @param formArray the form array\n     * @param parentGoal the optional parent goal\n     */\n    getLearningGoalsRecursive(goal, formArray, parentGoal) {\n        const group = this.fb.group({\n            id: [goal.value],\n            text: [goal.text],\n            completed: [false],\n        });\n        formArray.push(group);\n        const newGoal = {\n            id: goal.value,\n            text: goal.text,\n            completed: false,\n            subGoals: [],\n            parentGoal,\n            group,\n        };\n        this.goals.push(newGoal);\n        for (const child of goal.childItems) {\n            const childGoal = this.getLearningGoalsRecursive(child, formArray, newGoal);\n            newGoal.subGoals.push(childGoal);\n        }\n        return newGoal;\n    }\n}\nStudentSelfEvaluationComponent.ɵfac = function StudentSelfEvaluationComponent_Factory(t) { return new (t || StudentSelfEvaluationComponent)(i0.ɵɵdirectiveInject(i1.StudentSelfEvaluationService), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.CourseManagementService), i0.ɵɵdirectiveInject(i4.AccountService), i0.ɵɵdirectiveInject(i5.FormBuilder)); };\nStudentSelfEvaluationComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StudentSelfEvaluationComponent, selectors: [[\"jhi-student-self-evaluation\"]], decls: 33, vars: 12, consts: [[3, \"formGroup\", \"ngSubmit\"], [1, \"card\", \"m-3\"], [\"jhiTranslate\", \"overview.student.selfEvaluation.cardHeader\", 1, \"card-header\"], [\"class\", \"list-group list-group-flush\", 4, \"ngFor\", \"ngForOf\"], [1, \"card-footer\", \"text-center\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", \"mr-2\", 3, \"disabled\"], [\"class\", \"spinner-border spinner-border-sm mr-1\", 4, \"ngIf\"], [\"icon\", \"save\", 4, \"ngIf\"], [\"jhiTranslate\", \"overview.student.selfEvaluation.save\"], [\"type\", \"button\", \"jhiTranslate\", \"overview.student.selfEvaluation.cancel\", 1, \"btn\", \"btn-secondary\", 3, \"disabled\", \"click\"], [1, \"list-group\", \"list-group-flush\"], [1, \"list-group-item\", 3, \"formGroup\"], [1, \"card-title\"], [1, \"form-check-inline\"], [\"type\", \"radio\", \"formControlName\", \"completed\", 1, \"form-check-input\", 3, \"value\", \"click\"], [\"jhiTranslate\", \"overview.student.selfEvaluation.yes\", 1, \"form-check-label\"], [\"jhiTranslate\", \"overview.student.selfEvaluation.no\", 1, \"form-check-label\"], [1, \"spinner-border\", \"spinner-border-sm\", \"mr-1\"], [\"icon\", \"save\"]], template: function StudentSelfEvaluationComponent_Template(rf, ctx) { if (rf & 1) {\n        i0.ɵɵelementStart(0, \"form\", 0);\n        i0.ɵɵlistener(\"ngSubmit\", function StudentSelfEvaluationComponent_Template_form_ngSubmit_0_listener() { return ctx.submitChanges(); });\n        i0.ɵɵtext(1, \"\\n  \");\n        i0.ɵɵelementStart(2, \"h4\");\n        i0.ɵɵtext(3);\n        i0.ɵɵpipe(4, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(5, \"\\n\\n  \");\n        i0.ɵɵelement(6, \"jhi-alert-error\");\n        i0.ɵɵtext(7, \"\\n\\n  \");\n        i0.ɵɵelementStart(8, \"div\", 1);\n        i0.ɵɵtext(9, \"\\n    \");\n        i0.ɵɵelementStart(10, \"h5\", 2);\n        i0.ɵɵtext(11, \"Learning goals\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(12, \"\\n    \");\n        i0.ɵɵtemplate(13, StudentSelfEvaluationComponent_div_13_Template, 25, 9, \"div\", 3);\n        i0.ɵɵtext(14, \"\\n    \");\n        i0.ɵɵelementStart(15, \"div\", 4);\n        i0.ɵɵtext(16, \"\\n      \");\n        i0.ɵɵelementStart(17, \"button\", 5);\n        i0.ɵɵtext(18, \"\\n        \");\n        i0.ɵɵtemplate(19, StudentSelfEvaluationComponent_span_19_Template, 1, 0, \"span\", 6);\n        i0.ɵɵtext(20, \"\\n        \");\n        i0.ɵɵtemplate(21, StudentSelfEvaluationComponent_fa_icon_21_Template, 1, 0, \"fa-icon\", 7);\n        i0.ɵɵtext(22, \"\\u00A0\");\n        i0.ɵɵelementStart(23, \"span\", 8);\n        i0.ɵɵtext(24, \"Save\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(25, \"\\n      \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(26, \"\\n      \");\n        i0.ɵɵelementStart(27, \"button\", 9);\n        i0.ɵɵlistener(\"click\", function StudentSelfEvaluationComponent_Template_button_click_27_listener() { return ctx.navigateBack(); });\n        i0.ɵɵtext(28, \"\\n        Cancel\\n      \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(29, \"\\n    \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(30, \"\\n  \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(31, \"\\n\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(32, \"\\n\");\n    } if (rf & 2) {\n        i0.ɵɵproperty(\"formGroup\", ctx.studentSelfEvaluationForm);\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(4, 7, \"overview.student.selfEvaluation.header\", i0.ɵɵpureFunction1(10, _c1, ctx.courseInstanceInfo.courseName)));\n        i0.ɵɵadvance(10);\n        i0.ɵɵproperty(\"ngForOf\", ctx.goals);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"disabled\", ctx.isSaving);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.isSaving);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", !ctx.isSaving);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"disabled\", ctx.isSaving);\n    } }, directives: [i5.ɵNgNoValidate, i5.NgControlStatusGroup, i5.FormGroupDirective, i6.ɵa, i7.AlertErrorComponent, i8.TranslateDirective, i9.NgForOf, i9.NgIf, i5.RadioControlValueAccessor, i5.DefaultValueAccessor, i5.NgControlStatus, i5.FormControlName, i6.ɵk, i6.ɵe, i10.FaIconComponent], pipes: [i11.TranslatePipe], encapsulation: 2 });\n"]},"metadata":{},"sourceType":"module"}